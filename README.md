# 🚀 AI对话分析工具套件

基于 JavaScript 的 AI 对话分析工具，支持 LLM 时间分析、对话可视化和批量分析。

## ✨ 功能特点

### 📊 时间分析
- **LLM运行窗口分析**: 从assistant消息到下一个非assistant消息的时间跨度
- **LLM活跃周期分析**: 从用户触发到最后一个非用户消息的时间跨度
- **多时区支持**: UTC、上海、洛杉矶、纽约、伦敦等时区
- **CSV导出**: 支持导出分析结果

### 🎨 对话可视化
- **时间线展示**: 按时间顺序展示每条消息
- **用户Prompt突出**: 特别突出显示用户的初始提示
- **多模态内容**: 支持文本、图片、音频等内容类型
- **工具调用可视化**: 清晰展示AI工具调用过程
- **智能内容清理**: 自动移除技术性标识符，突出核心内容

### 🚀 批量分析
- **一次性分析多个对话**: 支持批量输入多个URL
- **快速概览**: 显示每个对话的Prompt、统计数据和时间信息
- **批量导出**: 支持CSV和JSON格式导出
- **实时进度**: 显示分析进度和状态

### 🌐 数据输入方式
- **本地文件上传**: 支持拖拽上传 time.json 文件
- **JSON粘贴**: 直接粘贴 JSON 内容进行分析
- **URL自动获取**: 支持从分享链接自动获取数据
- **批量URL处理**: 一次性处理多个对话链接

## 🚀 本地使用

### 启动本地服务器
```bash
python3 -m http.server 8000
```

### 访问工具
- **📊 主页**: http://localhost:8000/ - LLM时间分析工具
- **📱 对话可视化**: http://localhost:8000/conversation-view.html - 单个对话详细可视化
- **🚀 批量分析**: http://localhost:8000/batch-analysis.html - 批量对话分析

### 使用方式
1. **单个分析**: 上传文件、粘贴JSON或输入单个URL
2. **对话可视化**: 查看详细的对话内容和时间线
3. **批量分析**: 一次性分析多个对话，快速获取概览

## 📁 目录结构
```
├── index.html              # 主页面 - LLM时间分析
├── conversation-view.html  # 对话可视化页面
├── batch-analysis.html     # 批量分析页面
├── app.js                  # 主要逻辑
├── conversation-view.js    # 对话可视化逻辑
├── styles.css              # 样式文件
├── proxy-server.js         # 本地CORS代理服务器
├── start-servers.sh        # 启动脚本
├── py/
│   └── compute_llm_time.py # Python版本（参考）
└── README.md
```

## 🎯 核心特色

### 用户Prompt突出显示
- **专用展示区域**: 页面顶部美丽的渐变区域专门展示用户初始提示
- **纯文本提取**: 智能提取用户消息的核心内容，去除技术性JSON结构
- **双重展示**: 既在顶部专区显示，也在时间线中特殊标识

### 批量分析能力
- **并发处理**: 支持同时分析多个对话
- **实时反馈**: 显示分析进度和状态
- **统计概览**: 提供总体统计和每个对话的详细信息
- **导出功能**: 支持CSV和JSON格式的批量导出

### 智能内容处理
- **多模态支持**: 处理文本、图片、音频等不同类型的内容
- **内容清理**: 自动移除搜索词数组等技术性标识符
- **结构化展示**: 工具调用、函数调用等结构化数据的优雅展示

## 🔧 技术实现

### CORS解决方案
- 使用 `corsproxy.io` 作为主要代理服务
- 支持 POST 请求和复杂请求体
- 自动处理API的认证和跨域问题

### 数据处理
- **智能解析**: 自动识别不同的数据格式和结构
- **时区处理**: 支持多时区显示和转换
- **性能优化**: 高效处理大量对话数据

## 📊 数据格式

支持的 JSON 格式：
```json
{
  "data": [
    {
      "message_id": "uuid",
      "thread_id": "uuid", 
      "role": "user|assistant|tool",
      "type": "user|assistant|tool",
      "created_at": "2024-01-01T12:00:00Z",
      "content": "消息内容或多模态数组",
      "tool_calls": [...],
      "metadata": {...}
    }
  ]
}
```

## 🎯 使用场景
- **AI对话性能分析**: 评估LLM响应时间和效率
- **用户需求研究**: 分析用户初始需求和交互模式
- **批量质量评估**: 快速评估多个对话的质量和特征
- **产品优化**: 基于数据洞察优化AI产品体验

## 🌟 特别功能

### 批量分析示例
```
输入多个URL:
[分享链接1]
[分享链接2]

获得每个对话的:
✅ 用户初始Prompt
📊 消息统计 (总数/用户/助手/工具)
⏱️ 时间跨度和LLM运行时间
📱 直接跳转到详细可视化
```

### 智能Prompt提取
```
原始数据:
{"role": "user", "content": "I want to go to Kenya...\n\n[\"search terms\"]"}

提取结果:
"I want to go to Kenya..."  (自动移除技术性标识符)
```

这个工具套件让AI对话分析变得简单而强大！🎉